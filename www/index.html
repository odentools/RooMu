<!doctype html>
<html>

<!-- ここからヘッダー情報 -->

<head>

	<!-- 文字コードの指定 -->
	<meta http-equiv="Content-Type" content="text/html; charset = UTF-8">

	<!-- 検索巡回拒否の指定 -->
	<meta name="robots" content="NONE">
	<meta name="robots" content="noarchive">

	<!-- キャッシュの禁止 -->
	<meta name="robots" content="noarchive">

	<!-- 画面サイズの調整 -->
	<meta name="viewport" content="width = 1024">

	<!-- jQueryとsocket.ioを読み込む。 -->
	<script src="./jquery-1.11.0.min.js"></script>
	<script src="./socket.io-1.3.7.js"></script>

	<script>

var socket = io();
var videoTime = 0;
	
$(document).ready(function(){
	// 動画idを送信
	$('#send').on('click',function(){
		socket.emit('add',$('#url').val());
	});

	$('#play').on('click',function(){
		socket.emit('play','');
	});

	$('#pause').on('click',function(){
		socket.emit('pause','');
	});

	$('#mute').on('click',function(){
		socket.emit('mute','');
	});

	$('#next').on('click',function(){
		socket.emit('next','');
	});

	$('#volume').on('input',function(){
		socket.emit('volume',$(this).val());
	});

	$('#volume').change(function(){
		socket.emit('volume',$(this).val());
	});

	$('#up').on('click',function(){
		if ($('input[name=q2]:checked').val())
			socket.emit('up',$('input[name=q2]:checked').val());
	});

	$('#down').on('click',function(){
		if ($('input[name=q2]:checked').val())
			socket.emit('down',$('input[name=q2]:checked').val());
	});
	
	$('#delete').on('click',function(){
		if ($('input[name=q2]:checked').val())
			socket.emit('delete',$('input[name=q2]:checked').val());
	});
	
	$('#update').on('click',function(){
		socket.emit('update','');
	});

	socket.on('playList', function(list){
		setPlayListTable(list.playList);
		setHistoryListTable(list.historyList);
		showPlaing(list.historyList[list.historyList.length-1]);
	});
	
	socket.on('timeZero', function(){
		videoTime = 0;
	});
	
});

// playListのテーブルの作成
function setPlayListTable(playList){
	$('#playList table').empty();
		for (var arr in playList){
			$('#playList table').append($('<tr>').append( '<td><input class="point" type="radio" name="q2" value="'+arr+'"><td><img src="'+playList[arr].snippet.thumbnails.default.url+'"> <td>Title: ' + playList[arr].snippet.title + '<br>ID: ' + playList[arr].id + '<br>Time: ' + playList[arr].contentDetails.duration));
		}
}

// playListのテーブルの作成
function setHistoryListTable(historyList){
	$('#historyList table').empty();
		for (var arr in historyList){
			$('#historyList table').append($('<tr>').append( '<td><input class="point" type="radio" name="q2" value="'+arr+'"><td><img src="'+historyList[arr].snippet.thumbnails.default.url+'"> <td>Title: ' + historyList[arr].snippet.title + '<br>ID: ' + historyList[arr].id + '<br>Time: ' +historyList[arr].contentDetails.duration));
		}
}


function showPlaing(playing){
	console.log(playing);
	if(playing){
		$('#playing table').empty();
		$('#playing table').append($('<tr>').append( '<td><img src="'+playing.snippet.thumbnails.high.url+'"> <td>Title: ' + playing.snippet.title + '<br>ID: ' + playing.id + '<br>Time: ' +playing.contentDetails.duration));
	}
}
	</script>



	<body>
		
		<div id="playing">
			<table></table>
		</div>

		<br>

		<input id="play" type="button" value="再生">
		<input id="pause" type="button" value="一時停止">
		<input id="mute" type="button" value="ミュート">
		<input id="next" type="button" value="次の動画">
		<label>音量
			<input id="volume" type="range">
		</label>
		<br>
		<br>
		
		<input id="url"  type="text" style="width: 450px;">
		<input id="send" type="button" value="送信">
		<br>

		<hr>

		<div id="playList">
			<table></table>
		</div>

		<input id="up" type="button" value="上へ">
		<input id="down" type="button" value="下へ">
		<input id="delete" type="button" value="削除">
		<input id="update" type="button" value="更新">
		
		<hr>
		
		<div id="historyList">
			<table></table>
		</div>


	</body>

</html>